# GeoAc
Infrasonic ray tracing code

GeoAc is a numerical package written in C++ which solves the equations governing acoustic 
propagation through the atmosphere in the geometric limit using a RK4 algorithm.  It contains
multiple instances of said equation system and is able to model propagation in an azimuthal 
plane using the effective motionless medium approximation as well as in three dimensions 
using an inhomogeneous moving background medium.  The three dimensional propagation scheme 
include methods to model propagation in a Cartesian coordinate system as well as a spherical 
coordinate system which incorporates the curvature of the earth. 

This fork is a modified version of GeoAc to meet the needs of the workflow of the [IonoSeis](https://www.mdpi.com/2073-4433/10/8/443) modelling framework. 
Only 3D Stratified Global Propogation with the `-prop` option is currently supported

See [manual](https://github.com/BoiseState-AdaptLab/GeoAc/blob/main/GeoAc_Manual.pdf) for more information (Section 2.3).


## Installation

### On Boise State's R2 cluster

* Clone the repository
* The following modules are required:
  * slurm/17.11.12 
  * gcc/7.2.0 
  * openmpi4/gcc/4.0.1 
  * hdf5/gcc/1.10.5
  * netcdf/gcc/openmpi/4.7.4
* Run the `modules.sh` script to load the modules
* Run `make GeoAcGlobal` or `make all` to make the executable
* Run `make install` to install the executable in `/usr/local/bin`


## Running GeoAc
* Modify the `run_example.sh` script with your choice of input parameters
* Modify the `geoac_openmp.bash` script to suit your requirements
* Run `sbatch geoac_openmp.bash`
* The output is saved as `GeoAcResultsAndRaypaths.nc` and two DAT files `WASP_raypaths_Xthreads.dat` and `WASP_results_Xthreads.dat` where `X` is the number of threads specified in `run_example.sh`

## References

Keys, Robert G. "Cubic convolution interpolation for digital image processing." Acoustics, Speech and Signal Processing, IEEE Transactions on 29.6 (1981): 1153-1160.

Blom, Philip, and Roger Waxler. "Impulse propagation in the nocturnal boundary layer: Analysis of the geometric component." The Journal of the Acoustical Society of America 131.5 (2012): 3680-3690.

Blom, Philip. Interaction of the cyclonic winds with the infrasonic signal generated by a large maritime storm. Dissertation, University of Mississippi, ProQuest/UMI, 2013. (UMI No. 3567512)

___________________________________________
___________________________________________

[LANL Seismoacoustics](https://lanl-seismoacoustics.github.io/)
